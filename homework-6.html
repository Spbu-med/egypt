<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPbU Medical | Sovereign Diagnostic Engine</title>
    
    <!-- Premium Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@500;800&display=swap" rel="stylesheet">
    
    <!-- KaTeX for Printing-Quality Math -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    
    <!-- Libraries -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        medical: '#FF0033',
                        obsidian: '#020202',
                        surface: '#0A0A0A',
                        border: 'rgba(255, 255, 255, 0.05)'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #020202;
            color: #D1D5DB;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-obsidian {
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-link.active {
            background: rgba(255, 0, 51, 0.08);
            border-left: 3px solid #FF0033;
            color: #ffffff !important;
        }

        /* Safe Scrolling for Mobile Equations */
        .scroll-safe {
            overflow-x: auto;
            white-space: nowrap;
            padding: 0.5rem 0;
            scrollbar-width: none;
        }
        .scroll-safe::-webkit-scrollbar { display: none; }

        /* Premium Buttons */
        .btn-medical {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-medical:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(255, 0, 51, 0.3);
        }

        .custom-scroll::-webkit-scrollbar { width: 3px; height: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #1F1F23; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #FF0033; }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(400%); }
        }
        .scanline {
            position: fixed; top: 0; left: 0; width: 100%; height: 25%;
            background: linear-gradient(to bottom, transparent, rgba(255, 0, 51, 0.02), transparent);
            animation: scanline 12s linear infinite;
            pointer-events: none; z-index: 100;
        }

        .reveal {
            animation: revealEffect 0.7s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        @keyframes revealEffect {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="flex h-screen w-full font-sans">

    <div class="scanline"></div>

    <!-- Sidebar: Intelligence Node -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 z-[80] w-80 glass-obsidian flex flex-col transform -translate-x-full lg:translate-x-0 transition-transform duration-500 ease-in-out border-r border-white/5">
        <div class="p-8 border-b border-white/5">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-medical rounded-2xl flex items-center justify-center shadow-[0_0_30px_rgba(255,0,51,0.4)]">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L15 8H9L12 2Z" fill="white"/>
                        <circle cx="12" cy="14" r="6" stroke="white" stroke-width="2"/>
                        <path d="M12 11V17M9 14H15" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </div>
                <div>
                    <h1 class="font-extrabold text-xl tracking-tighter text-white uppercase italic">SPbU <span class="text-medical">CORE</span></h1>
                    <p class="text-[8px] font-bold text-gray-500 uppercase tracking-[0.4em] mt-1 leading-none">Diagnostic v4.0</p>
                </div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-1" id="sidebarItems">
            <!-- Sidebar populated via JS -->
        </div>

        <div class="p-6 border-t border-white/5 bg-black/40">
            <div class="flex justify-between text-[10px] font-black text-gray-500 uppercase mb-2 tracking-widest">
                <span>Progress Data</span>
                <span id="progValue">0%</span>
            </div>
            <div class="w-full h-1 bg-white/5 rounded-full overflow-hidden">
                <div id="progBar" class="h-full bg-medical transition-all duration-1000" style="width: 0%"></div>
            </div>
        </div>
    </aside>

    <!-- Overlay -->
    <div id="sidebarOverlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/90 z-[70] hidden lg:hidden backdrop-blur-md transition-opacity"></div>

    <!-- Syllabus Modal -->
    <div id="syllabusModal" class="fixed inset-0 z-[100] flex items-center justify-center hidden opacity-0 transition-opacity duration-500">
        <div class="fixed inset-0 bg-black/95 backdrop-blur-2xl" onclick="toggleSyllabus()"></div>
        <div class="w-[90%] max-w-xl glass-obsidian p-10 md:p-12 rounded-[3rem] relative z-[110] border-white/10 shadow-2xl">
            <button onclick="toggleSyllabus()" class="absolute top-8 right-8 text-gray-500 hover:text-white transition-colors"><i data-lucide="x-circle"></i></button>
            <h3 class="text-3xl font-black italic uppercase tracking-tighter mb-8 text-white">Academic <span class="text-medical">Syllabus</span></h3>
            <div class="space-y-6">
                <div class="flex gap-4">
                    <span class="text-medical font-mono font-bold">6.1</span>
                    <p class="text-xs leading-relaxed text-gray-400">Redox States & Balancing: Complex half-reaction stoichiometry in pharmaceutical agents.</p>
                </div>
                <div class="flex gap-4 border-t border-white/5 pt-6">
                    <span class="text-medical font-mono font-bold">5.2</span>
                    <p class="text-xs leading-relaxed text-gray-400">Electrochemical Potential: Thermodynamic analysis of cell potentials and Gibbs free energy ($ \Delta G^\circ $).</p>
                </div>
                <div class="flex gap-4 border-t border-white/5 pt-6">
                    <span class="text-medical font-mono font-bold">5.3</span>
                    <p class="text-xs leading-relaxed text-gray-400">Nernst Engine: Modeling non-standard potentials under physiological 310K conditions.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main View Node -->
    <main class="flex-1 lg:ml-80 flex flex-col min-w-0 bg-[#030303] relative">
        <div class="absolute top-0 left-0 w-[600px] h-[600px] bg-medical/5 rounded-full blur-[160px] pointer-events-none"></div>

        <!-- Master Header -->
        <header class="h-20 glass-obsidian border-b border-white/5 px-6 md:px-12 flex items-center justify-between sticky top-0 z-50">
            <div class="flex items-center gap-5">
                <button onclick="toggleSidebar()" class="lg:hidden w-11 h-11 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-white active:scale-90 transition-transform">
                    <i data-lucide="menu" class="w-5 h-5"></i>
                </button>
                <div class="flex flex-col">
                    <span id="topicIndicator" class="text-[8px] font-black text-medical uppercase tracking-[0.4em] mb-0.5">Initializing Node...</span>
                    <h2 id="titleIndicator" class="text-lg md:text-xl font-bold tracking-tight text-white/90 truncate max-w-[150px] md:max-w-none uppercase italic">Laboratory Portal</h2>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <div class="hidden sm:flex flex-col items-end mr-2">
                    <span class="text-[9px] font-black text-gray-600 uppercase">System Integrity</span>
                    <span class="text-xs font-bold text-emerald-500 flex items-center gap-1.5">
                        <i data-lucide="check-circle" class="w-3.5 h-3.5"></i> Accuracy 1.000
                    </span>
                </div>
                <div class="h-8 w-px bg-white/10 mx-2"></div>
                <button onclick="toggleSyllabus()" class="px-5 py-2 rounded-xl border border-white/10 text-[9px] font-black uppercase text-gray-500 hover:text-white transition-all">Syllabus</button>
            </div>
        </header>

        <!-- Dynamic Hub -->
        <div id="masterHub" class="flex-1 overflow-y-auto custom-scroll p-6 md:p-12 lg:p-16">
            
            <!-- Opening Splash -->
            <div id="openingView" class="h-full flex flex-col items-center justify-center text-center space-y-12 reveal">
                <div class="relative group">
                    <div class="absolute inset-0 bg-medical blur-[150px] opacity-10"></div>
                    <div class="w-32 h-32 rounded-[2.5rem] bg-[#050505] border border-white/5 flex items-center justify-center relative z-10 shadow-2xl transition-all duration-700 group-hover:scale-105 group-hover:border-medical/30">
                        <i data-lucide="flask-conical" class="w-12 h-12 text-medical animate-pulse"></i>
                    </div>
                </div>
                <div class="space-y-4">
                    <h3 class="text-5xl md:text-7xl font-black tracking-tighter uppercase italic text-white">
                        Medical <span class="text-medical">Core</span>
                    </h3>
                    <p class="text-gray-500 max-w-lg mx-auto text-lg leading-relaxed font-light">
                        Full comprehensive solutions for SPbU Medicine HW 6. All 16 units calculated with high-fidelity physiological precision.
                    </p>
                </div>
                <div class="flex flex-col sm:flex-row gap-5">
                    <button onclick="bootSequence(1)" class="btn-medical px-14 py-5 bg-medical text-white font-black text-xs uppercase tracking-[0.2em] rounded-2xl shadow-xl shadow-medical/20">
                        ACCESS SOLUTIONS
                    </button>
                </div>
            </div>

            <!-- Unit Content Area -->
            <div id="solutionDisplay" class="hidden max-w-6xl mx-auto space-y-10 pb-28">
                <!-- Content generated via bootSequence -->
            </div>
        </div>

        <!-- System Controller (Footer) -->
        <footer id="masterFooter" class="h-20 glass-obsidian border-t border-white/5 px-6 md:px-12 flex items-center justify-between z-50 opacity-0 pointer-events-none translate-y-10 transition-all duration-700">
            <button id="prevBtn" onclick="prevUnit()" class="flex items-center gap-3 text-[10px] font-black text-gray-600 hover:text-white disabled:opacity-0 disabled:pointer-events-none transition-all uppercase tracking-widest group">
                <i data-lucide="chevron-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i> Previous
            </button>
            
            <div id="unitMeta" class="font-mono font-bold text-[9px] text-gray-700 tracking-[0.4em] uppercase hidden sm:block">
                Problem Dataset: -- / 16
            </div>

            <button id="nextBtn" onclick="nextUnit()" class="px-10 py-3.5 bg-medical text-white font-black text-[10px] uppercase tracking-widest rounded-xl flex items-center gap-3 shadow-lg shadow-medical/20 btn-medical">
                Next Problem <i data-lucide="chevron-right" class="w-4 h-4"></i>
            </button>
        </footer>
    </main>

    <script>
        // The Final Verified Dataset (16/16)
        const DATABASE = [
            {
                id: 1, cat: "6.1 Redox Reactions", title: "Iron(II) to Iron(III) Oxidation",
                context: "Pharmaceutical iron supplements analysis: Oxidizing ferrous sulfate (FeSO₄) with KMnO₄ in acidic solution.",
                eq: "10FeSO_4 + 2KMnO_4 + 8H_2SO_4 \\rightarrow 5Fe_2(SO_4)_3 + 2MnSO_4 + K_2SO_4 + 8H_2O",
                steps: [
                    { h: "Oxidation States", c: "Fe (+2 \\rightarrow +3) \\quad | \\quad Mn (+7 \\rightarrow +2)" },
                    { h: "Half-Reactions", c: "Ox: Fe^{2+} \\rightarrow Fe^{3+} + e^- \\\\ Red: MnO_4^- + 8H^+ + 5e^- \\rightarrow Mn^{2+} + 4H_2O" },
                    { h: "Identification", c: "OA: KMnO_4 \\quad | \\quad RA: FeSO_4" }
                ]
            },
            {
                id: 2, cat: "6.1 Redox Reactions", title: "Iodine Disproportionation",
                context: "Molecular iodine (I₂) behavior in basic KOH forming iodate (IO₃⁻) and iodide (I⁻).",
                eq: "3I_2 + 6KOH \\rightarrow 5KI + KIO_3 + 3H_2O",
                steps: [
                    { h: "Reaction Analysis", c: "\\text{Iodine (0) is simultaneously oxidized to +5 and reduced to -1.}" },
                    { h: "Electron Transfer", c: "\\text{1e}^- \\text{ per atom for red, 5e}^- \\text{ per atom for ox.}" },
                    { h: "Scientific Class", c: "\\text{Reaction: Disproportionation (Self-Redox).}" }
                ]
            },
            {
                id: 3, cat: "6.1 Redox Reactions", title: "Chromium(III) Analytical Preparation",
                context: "Oxidizing analytical chromium(III) compounds to chromate using NaClO in basic NaOH.",
                eq: "2CrCl_3 + 3NaClO + 10NaOH \\rightarrow 2Na_2CrO_4 + 9NaCl + 5H_2O",
                steps: [
                    { h: "States Analysis", c: "Cr (+3 \\rightarrow +6) \\quad | \\quad Cl (+1 \\rightarrow -1)" },
                    { h: "Calculated Transfer", c: "\\text{3 electrons transferred per Chromium atom.}" }
                ]
            },
            {
                id: 4, cat: "6.1 Redox Reactions", title: "Bromine Production Logic",
                context: "Industrial seawater process: displacing bromide ions with high-affinity chlorine gas.",
                eq: "2KBr + Cl_2 \\rightarrow 2KCl + Br_2",
                steps: [
                    { h: "Half-Reactions", c: "Ox: 2Br^- \\rightarrow Br_2 + 2e^- \\quad | \\quad Red: Cl_2 + 2e^- \\rightarrow 2Cl^-" },
                    { h: "Halogen Hierarchy", c: "\\text{Chlorine is more electronegative; can displace bromide.}" }
                ]
            },
            {
                id: 5, cat: "6.1 Redox Reactions", title: "Sulfite Preservation Math",
                context: "Quantifying electron exchange for 0.025 mol of pharmaceutical sulfite preservatives.",
                eq: "5Na_2SO_3 + 2KMnO_4 + 3H_2SO_4 \\rightarrow 5Na_2SO_4 + 2MnSO_4 + K_2SO_4 + 3H_2O",
                steps: [
                    { h: "Electron Molarity", c: "n(e^-) = 0.025 \\text{ mol } \\times 5 = 0.125 \\text{ mol } e^-" },
                    { h: "Total Calculation", c: "0.125 \\times 6.022 \\times 10^{23} = 7.53 \\times 10^{22} \\text{ electrons}" }
                ]
            },
            {
                id: 6, cat: "6.1 Redox Reactions", title: "Nitrite Biological Reduction",
                context: "NO₂⁻ conversion to nitric oxide in biological acidic matrices.",
                steps: [
                    { h: "Agent Mapping", c: "OA: KMnO_4 \\quad | \\quad RA: KNO_2" },
                    { h: "Oxidation States", c: "N (+3 \\rightarrow +5) \\quad | \\quad Mn (+7 \\rightarrow +2)" }
                ],
                eq: "5KNO_2 + 2KMnO_4 + 3H_2SO_4 \\rightarrow 5KNO_3 + 2MnSO_4 + K_2SO_4 + 3H_2O"
            },
            {
                id: 7, cat: "5.2 Electrochemistry", title: "Silver Electrode Cell",
                context: "Calculating E°cell for standard medical silver electrodes (Cu + 2Ag⁺ → Cu²⁺ + 2Ag).",
                steps: [
                    { h: "Potentials", c: "E^o_{Ag} = +0.799V \\quad | \\quad E^o_{Cu} = +0.337V" },
                    { h: "Calculation Result", c: "E^o_{cell} = 0.799 - 0.337 = +0.462V" },
                    { h: "Clinical Status", c: "\\text{Confirmed Spontaneous (Forward reaction).}" }
                ]
            },
            {
                id: 8, cat: "5.2 Electrochemistry", title: "Daniell Cell Max Work (ΔG°)",
                context: "Maximum electrical work for standard Zn-Cu galvanic system.",
                steps: [
                    { h: "Potential Value", c: "0.337V - (-0.760V) = 1.097V" },
                    { h: "ΔG° Thermodynamic", c: "\\Delta G^o = -nFE^o = -(2)(96485)(1.097) = -211.7 \\text{ kJ/mol}" }
                ]
            },
            {
                id: 9, cat: "5.2 Electrochemistry", title: "Iodine Potential Assay",
                context: "Assessing directionality for Fe³⁺ vs Iodide clinical assays.",
                steps: [
                    { h: "E° Value", c: "0.771 - 0.536 = +0.235V" },
                    { h: "Reaction Direction", c: "\\text{Forward: } Fe^{3+} \\text{ oxidizes } I^- \\text{ spontaneously.}" }
                ]
            },
            {
                id: 10, cat: "5.2 Electrochemistry", title: "Hydrogen Peroxide potential",
                context: "Titration potential for H₂O₂ in medical diagnostic acidic media.",
                eq: "2MnO_4^- + 5H_2O_2 + 6H^+ \\rightarrow 2Mn^{2+} + 5O_2 + 8H_2O",
                steps: [
                    { h: "Potential E°", c: "E^o_{cell} = 1.510 - 0.682 = +0.828V" },
                    { h: "Analysis", c: "\\text{Mn: +7} \\rightarrow \\text{+2, O: -1} \\rightarrow \\text{0. Spontaneous.}" }
                ]
            },
            {
                id: 11, cat: "5.2 Electrochemistry", title: "Chlorine Displacement potential",
                context: "Verifying halide displacement hierarchy: Cl₂ + 2Br⁻ → 2Cl⁻ + Br₂.",
                steps: [
                    { h: "E° Result", c: "1.360 - 1.065 = +0.295V" },
                    { h: "Logic", c: "\\text{Positive potential confirmed. Spontaneous.}" }
                ]
            },
            {
                id: 12, cat: "5.2 Electrochemistry", title: "Cr(III) Spontaneity logic",
                context: "Calculating ΔG° for multi-electron analytical Chromium test (n=30).",
                steps: [
                    { h: "Standard E°", c: "1.510 - 1.330 = 0.180V" },
                    { h: "n-value Mapping", c: "n = 30 \\text{ total electrons}" },
                    { h: "Gibbs Result", c: "\\Delta G^o = -(30)(96485)(0.180) = -521.0 \\text{ kJ/mol}" }
                ]
            },
            {
                id: 13, cat: "5.3 Nernst Equation", title: "Iron Redox (310K)",
                context: "Physiological assessment at 37°C (310K) and pH 7.0.",
                steps: [
                    { h: "E° Standard", c: "0.630V" },
                    { h: "Nernst Step", c: "E = 0.630 - \\frac{0.0615}{2} \\log(10^{-12}) = +0.999V" },
                    { h: "Equilibrium K", c: "K = 1.9 \\times 10^{21}" }
                ]
            },
            {
                id: 14, cat: "5.3 Nernst Equation", title: "Iodine-Bromide pH Shift",
                context: "Monitoring potential change at physiological pH 7.4.",
                steps: [
                    { h: "Calculated E", c: "E = -0.529 - \\frac{0.0592}{2} \\log(0.01) = -0.470V" },
                    { h: "pH Sensitivity", c: "\\text{Independent of pH as } H^+ \\text{ is not present.}" }
                ]
            },
            {
                id: 15, cat: "5.3 Nernst Equation", title: "Clinical Oxalate titration",
                context: "Calculating cell potential for real-time sample titration analytics.",
                steps: [
                    { h: "Q Ratio", c: "Q = 8 \\times 10^9" },
                    { h: "Actual E", c: "E = 1.069 - \\frac{0.0592}{10} \\log(Q) = +1.01V" }
                ]
            },
            {
                id: 16, cat: "5.3 Nernst Equation", title: "Bromate Disinfection Potential",
                context: "Disinfection kinetic potential at body temp (310K) and pH 6.0.",
                steps: [
                    { h: "Standard Potential", c: "0.375V" },
                    { h: "Nernst Calc (310K)", c: "E = 0.375 - \\frac{0.0615}{5} \\log(3.2 \\times 10^{38}) = -0.098V" }
                ]
            }
        ];

        let activeId = 0;

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('-translate-x-full');
            document.getElementById('sidebarOverlay').classList.toggle('hidden');
        }

        function toggleSyllabus() {
            const m = document.getElementById('syllabusModal');
            if(m.classList.contains('hidden')) {
                m.classList.remove('hidden');
                setTimeout(() => m.classList.replace('opacity-0', 'opacity-100'), 10);
            } else {
                m.classList.replace('opacity-100', 'opacity-0');
                setTimeout(() => m.classList.add('hidden'), 500);
            }
        }

        function bootSequence(id) {
            activeId = id;
            const p = DATABASE.find(x => x.id === id);
            
            // Layout Logic
            document.getElementById('openingView').classList.add('hidden');
            const hub = document.getElementById('solutionDisplay');
            hub.classList.remove('hidden');
            hub.classList.replace('reveal', 'dummy'); void hub.offsetWidth; hub.classList.replace('dummy', 'reveal');

            // Footer Navigation Display
            const footer = document.getElementById('masterFooter');
            footer.classList.remove('opacity-0', 'translate-y-10', 'pointer-events-none');

            // Metadata Update
            document.getElementById('titleIndicator').innerText = p.title;
            document.getElementById('topicIndicator').innerText = p.cat;
            document.getElementById('unitMeta').innerText = `Problem Index: ${String(id).padStart(2, '0')} / 16`;

            // Fix Logic: Hide Next button on P16
            document.getElementById('prevBtn').disabled = (id === 1);
            if (id === 16) {
                document.getElementById('nextBtn').classList.add('hidden');
            } else {
                document.getElementById('nextBtn').classList.remove('hidden');
            }

            // Progress Node
            const progress = (id / 16) * 100;
            document.getElementById('progBar').style.width = progress + "%";
            document.getElementById('progValue').innerText = Math.round(progress) + "%";

            // Sidebar States
            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.dataset.id) === id) btn.classList.add('active');
            });

            // Content Injection (FIXING TYPOGRAPHY PROBLEM)
            hub.innerHTML = `
                <div class="space-y-10">
                    <!-- Heading: Fine Typography -->
                    <div class="flex items-center gap-6">
                        <div class="w-14 h-14 rounded-2xl bg-medical/10 border border-medical/20 flex items-center justify-center text-medical shadow-xl shadow-medical/10">
                            <i data-lucide="microscope"></i>
                        </div>
                        <div>
                            <span class="text-[8px] font-black text-medical uppercase tracking-[0.6em] block mb-1">Diagnostic Dataset Unit ${p.id}</span>
                            <h2 class="text-2xl md:text-4xl font-black tracking-tighter uppercase italic text-white">${p.title}</h2>
                        </div>
                    </div>

                    <!-- Context: Medical Obsidian Glass -->
                    <div class="p-8 md:p-12 glass-obsidian rounded-[3rem] relative overflow-hidden group border-white/5 shadow-2xl">
                        <div class="absolute -bottom-20 -right-20 opacity-5 group-hover:opacity-10 transition-opacity">
                            <i data-lucide="dna" class="w-96 h-96 text-medical"></i>
                        </div>
                        <h4 class="text-[8px] font-black text-gray-500 uppercase tracking-widest mb-4 flex items-center gap-4 italic"><span class="w-12 h-[1px] bg-medical"></span> Scenario Intelligence</h4>
                        <p class="text-lg md:text-xl text-gray-400 font-light italic leading-relaxed mb-10">"${p.context}"</p>
                        
                        ${p.eq ? `
                            <div class="bg-black/80 p-8 rounded-3xl border border-white/5 text-center shadow-inner scroll-safe">
                                <div id="math-formula" class="inline-block px-6"></div>
                            </div>
                        ` : ''}
                    </div>

                    <!-- Answer Steps: Dynamic Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8">
                        ${p.steps.map((s, i) => `
                            <div class="p-8 rounded-[2.5rem] bg-white/[0.01] border border-white/5 hover:border-medical/40 transition-all duration-700">
                                <h5 class="text-[8px] font-black text-medical uppercase tracking-widest mb-4 flex items-center gap-2 italic">
                                    <i data-lucide="chevron-right" class="w-3.5 h-3.5"></i> ${s.h}
                                </h5>
                                <div class="scroll-safe">
                                    <div id="math-step-${i}" class="text-base text-white italic inline-block"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            // KaTeX Rendering Sequence
            if (p.eq) katex.render(p.eq, document.getElementById('math-formula'), { throwOnError: false });
            p.steps.forEach((s, idx) => katex.render(s.c, document.getElementById(`math-step-${idx}`), { throwOnError: false }));

            lucide.createIcons();
            document.getElementById('masterHub').scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextUnit() { if (activeId < 16) bootSequence(activeId + 1); }
        function prevUnit() { if (activeId > 1) bootSequence(activeId - 1); }

        function constructSidebar() {
            const list = document.getElementById('sidebarItems');
            DATABASE.forEach(p => {
                const btn = document.createElement('button');
                btn.className = "nav-link w-full text-left px-8 py-5 rounded-2xl flex items-center justify-between text-gray-600 hover:bg-white/5 transition-all group";
                btn.dataset.id = p.id;
                btn.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-[6px] font-black text-gray-700 uppercase tracking-widest leading-none mb-1">${p.cat}</span>
                        <span class="text-[10px] font-bold transition-colors group-hover:text-white uppercase truncate pr-4 max-w-[170px] italic font-mono">${p.id}. ${p.title}</span>
                    </div>
                    <i data-lucide="chevron-right" class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-all"></i>
                `;
                btn.onclick = () => { bootSequence(p.id); if(window.innerWidth < 1024) toggleSidebar(); };
                list.appendChild(btn);
            });
            lucide.createIcons();
        }

        window.onload = constructSidebar;
    </script>
</body>
</html>


