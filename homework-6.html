<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SPbU Medical | Sovereign Diagnostic Engine</title>
    
    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    
    <!-- KaTeX for Printing-Quality Equations -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    
    <!-- Core Engine Libraries -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Plus Jakarta Sans', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        medical: '#FF0033',
                        obsidian: '#020202',
                        card: '#080808',
                        border: 'rgba(255, 255, 255, 0.05)'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #020202;
            color: #D1D5DB;
            overflow: hidden;
            -webkit-tap-highlight-color: transparent;
        }

        .glass-obsidian {
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-link.active {
            background: rgba(255, 0, 51, 0.1);
            border-left: 4px solid #FF0033;
            color: #ffffff !important;
        }

        /* Safe Scrolling for Equations on Mobile */
        .math-safe-zone {
            overflow-x: auto;
            white-space: nowrap;
            padding: 1rem 0;
            scrollbar-width: none;
        }
        .math-safe-zone::-webkit-scrollbar { display: none; }

        .btn-action {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .btn-action:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 0 35px rgba(255, 0, 51, 0.4);
        }

        .custom-scroll::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #FF0033; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .reveal { animation: fadeIn 0.6s ease-out forwards; }
    </style>
</head>
<body class="flex h-screen w-full font-sans">

    <!-- Sidebar: The Sovereign Core -->
    <aside id="sidebar" class="fixed inset-y-0 left-0 z-[100] w-80 glass-obsidian flex flex-col transition-transform duration-500 lg:translate-x-0 -translate-x-full border-r border-white/5">
        <div class="p-8 border-b border-white/5">
            <div class="flex items-center gap-4">
                <!-- Advanced SVG Medical Logo -->
                <div class="w-12 h-12 bg-medical rounded-2xl flex items-center justify-center shadow-[0_0_30px_rgba(255,0,51,0.5)]">
                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2L15 8H9L12 2Z" fill="white"/>
                        <circle cx="12" cy="14" r="6" stroke="white" stroke-width="2"/>
                        <path d="M12 11V17M9 14H15" stroke="white" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                </div>
                <div>
                    <h1 class="font-extrabold text-xl tracking-tighter text-white uppercase italic">SPbU <span class="text-medical">CORE</span></h1>
                    <p class="text-[8px] font-bold text-gray-500 uppercase tracking-[0.4em] leading-none mt-1">Sovereign Engine v5</p>
                </div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-1.5" id="sidebarNav">
            <!-- Populated via JS -->
        </div>

        <div class="p-6 border-t border-white/5 bg-black/40">
            <div class="flex justify-between text-[10px] font-black text-gray-600 uppercase mb-2">
                <span>Core Analytics</span>
                <span id="progLabel">0%</span>
            </div>
            <div class="w-full h-1 bg-white/5 rounded-full overflow-hidden">
                <div id="progBar" class="h-full bg-medical transition-all duration-1000" style="width: 0%"></div>
            </div>
        </div>
    </aside>

    <!-- Overlay for Mobile -->
    <div id="sidebarOverlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/90 z-[90] hidden lg:hidden backdrop-blur-md"></div>

    <!-- Main View Node -->
    <main class="flex-1 lg:ml-80 flex flex-col min-w-0 bg-[#020202] relative">
        <div class="absolute top-0 left-0 w-[500px] h-[500px] bg-medical/5 rounded-full blur-[140px] pointer-events-none"></div>

        <!-- Master Header -->
        <header class="h-20 glass-obsidian border-b border-white/5 px-6 md:px-12 flex items-center justify-between sticky top-0 z-[110]">
            <div class="flex items-center gap-5">
                <button onclick="toggleSidebar()" class="lg:hidden w-11 h-11 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-white active:scale-90 transition-transform">
                    <i data-lucide="menu" class="w-5 h-5"></i>
                </button>
                <div class="flex flex-col">
                    <span id="topicRef" class="text-[8px] font-black text-medical uppercase tracking-[0.4em] mb-0.5">Initializing Node...</span>
                    <h2 id="titleRef" class="text-base md:text-xl font-bold tracking-tight text-white/90 truncate max-w-[150px] md:max-w-none italic">Chemistry Lab</h2>
                </div>
            </div>

            <div class="flex items-center gap-4">
                <div class="hidden sm:flex flex-col items-end mr-2">
                    <span class="text-[9px] font-black text-gray-700 uppercase">System Integrity</span>
                    <span class="text-xs font-bold text-emerald-500 flex items-center gap-1.5">
                        <i data-lucide="check-circle" class="w-3.5 h-3.5"></i> Verified
                    </span>
                </div>
                <div class="h-8 w-px bg-white/10 mx-2"></div>
                <button onclick="toggleSyllabus()" class="px-5 py-2 rounded-xl border border-white/10 text-[9px] font-black uppercase text-gray-400 hover:text-white transition-all">Syllabus</button>
            </div>
        </header>

        <!-- Content Engine -->
        <div id="masterHub" class="flex-1 overflow-y-auto custom-scroll p-6 md:p-12 lg:p-16 relative">
            
            <!-- Opening Screen -->
            <div id="welcomeView" class="h-full flex flex-col items-center justify-center text-center space-y-12 reveal">
                <div class="relative group">
                    <div class="absolute inset-0 bg-medical blur-[150px] opacity-15"></div>
                    <div class="w-32 h-32 rounded-[2.5rem] bg-obsidian border border-white/10 flex items-center justify-center relative z-10 shadow-2xl transition-transform duration-700 group-hover:scale-105">
                        <i data-lucide="dna" class="w-14 h-14 text-medical animate-pulse"></i>
                    </div>
                </div>
                <div class="space-y-4">
                    <h3 class="text-5xl md:text-7xl font-black tracking-tighter uppercase italic text-white">
                        Diagnostic <span class="text-medical">Engine</span>
                    </h3>
                    <p class="text-gray-500 max-w-xl mx-auto text-lg leading-relaxed font-light px-6 italic">
                        Authorized analytical portal for HW 6. All 16 problems solved with physiological 310K precision and high-fidelity calculus.
                    </p>
                </div>
                <button onclick="loadUnit(1)" class="btn-action px-14 py-5 bg-medical text-white font-black text-[11px] uppercase tracking-widest rounded-2xl shadow-2xl shadow-medical/30">
                    ACCESS HW6 SOLUTIONS
                </button>
            </div>

            <!-- Canvas for Data -->
            <div id="solutionCanvas" class="hidden max-w-6xl mx-auto space-y-12 pb-32">
                <!-- Data Mapping -->
            </div>
        </div>

        <!-- Master Controller Footer -->
        <footer id="masterFooter" class="h-20 glass-obsidian border-t border-white/5 px-6 md:px-12 flex items-center justify-between z-[120] opacity-0 translate-y-full pointer-events-none transition-all duration-700">
            <button id="prevBtn" onclick="prevUnit()" class="btn-action flex items-center gap-3 text-[10px] font-black text-gray-500 hover:text-white disabled:opacity-0 disabled:pointer-events-none uppercase tracking-widest group">
                <i data-lucide="chevron-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i> Previous
            </button>
            
            <div id="unitIndicator" class="font-mono font-bold text-xs text-gray-700 tracking-[0.4em] uppercase hidden sm:block">
                -- / 16
            </div>

            <div id="nextArea">
                <button id="nextBtn" onclick="nextUnit()" class="btn-action px-12 py-3.5 bg-medical text-white font-black text-[10px] uppercase tracking-widest rounded-xl flex items-center gap-3 shadow-lg shadow-medical/20">
                    Next Unit <i data-lucide="chevron-right" class="w-4 h-4"></i>
                </button>
                <a id="homeBtn" href="index.html" class="hidden px-10 py-3.5 bg-emerald-600 text-white font-black text-[10px] uppercase tracking-widest rounded-xl flex items-center gap-3 shadow-lg shadow-emerald-500/20">
                    RETURN TO PORTAL <i data-lucide="home" class="w-4 h-4"></i>
                </a>
            </div>
        </footer>
    </main>

    <!-- Syllabus Modal -->
    <div id="syllabusModal" class="fixed inset-0 z-[200] flex items-center justify-center hidden opacity-0 transition-opacity duration-500">
        <div class="fixed inset-0 bg-black/95 backdrop-blur-2xl" onclick="toggleSyllabus()"></div>
        <div class="w-[90%] max-w-xl glass-obsidian p-10 md:p-12 rounded-[3.5rem] relative z-[210] border-white/10">
            <button onclick="toggleSyllabus()" class="absolute top-10 right-10 text-gray-500 hover:text-white transition-colors"><i data-lucide="x-circle"></i></button>
            <h3 class="text-3xl font-black italic uppercase tracking-tighter mb-8 text-white">Academic <span class="text-medical">Syllabus</span></h3>
            <div class="space-y-6 text-sm">
                <div class="flex gap-4">
                    <span class="text-medical font-bold">6.1</span>
                    <p class="text-gray-400">Redox States & Half-Reaction stoichiometry for pharmaceutical stabilizers.</p>
                </div>
                <div class="flex gap-4 border-t border-white/5 pt-6">
                    <span class="text-medical font-bold">5.2</span>
                    <p class="text-gray-400">Standard cell potentials (E°cell) and Gibbs Free Energy thermodynamics.</p>
                </div>
                <div class="flex gap-4 border-t border-white/5 pt-6">
                    <span class="text-medical font-bold">5.3</span>
                    <p class="text-gray-400">Advanced Nernst modeling under physiological 310K conditions.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DATABASE = [
            // TOPIC 6.1
            {
                id: 1, topic: "6.1 Redox Reactions", title: "Iron(II) to Iron(III) Oxidation",
                context: "Pharmaceutical iron supplements analysis: Balacing FeSO₄ oxidation by acidic KMnO₄.",
                eq: "10FeSO_4 + 2KMnO_4 + 8H_2SO_4 \\rightarrow 5Fe_2(SO_4)_3 + 2MnSO_4 + K_2SO_4 + 8H_2O",
                steps: [
                    { h: "Oxidation States", c: "Fe (+2 \\rightarrow +3) \\quad | \\quad Mn (+7 \\rightarrow +2)" },
                    { h: "Half-Reactions", c: "Ox: Fe^{2+} \\rightarrow Fe^{3+} + e^- \\\\ Red: MnO_4^- + 8H^+ + 5e^- \\rightarrow Mn^{2+} + 4H_2O" },
                    { h: "Agents", c: "OA: KMnO_4 \\quad | \\quad RA: FeSO_4" }
                ]
            },
            {
                id: 2, topic: "6.1 Redox Reactions", title: "Iodine Disproportionation",
                context: "Evaluating molecular iodine (I₂) behavior in basic KOH forming antiseptic complexes.",
                eq: "3I_2 + 6KOH \\rightarrow 5KI + KIO_3 + 3H_2O",
                steps: [
                    { h: "Process Logic", c: "\\text{Iodine (0) is simultaneously oxidized to +5 and reduced to -1.}" },
                    { h: "Electron Transfer", c: "\\text{1e}^- \\text{ for red and 5e}^- \\text{ for ox per atom.}" },
                    { h: "Reaction Type", c: "\\text{Disproportionation (Self-Redox).}" }
                ]
            },
            {
                id: 3, topic: "6.1 Redox Reactions", title: "Chromium(III) Preparation",
                context: "Oxidizing chromium(III) for spectrophotometric chromate analysis.",
                eq: "2CrCl_3 + 3NaClO + 10NaOH \\rightarrow 2Na_2CrO_4 + 9NaCl + 5H_2O",
                steps: [
                    { h: "Ox States", c: "Cr (+3 \\rightarrow +6) \\quad | \\quad Cl (+1 \\rightarrow -1)" },
                    { h: "Total Count", c: "\\text{3 electrons transferred per Chromium atom.}" }
                ]
            },
            {
                id: 4, topic: "6.1 Redox Reactions", title: "Bromine Halogen extraction",
                context: "Extracting elemental bromine from seawater via chlorine gas displacement.",
                eq: "2KBr + Cl_2 \\rightarrow 2KCl + Br_2",
                steps: [
                    { h: "Half-Reactions", c: "Ox: 2Br^- \\rightarrow Br_2 + 2e^- \\quad | \\quad Red: Cl_2 + 2e^- \\rightarrow 2Cl^-" },
                    { h: "Rationale", c: "\\text{Chlorine is a stronger oxidizer due to higher affinity.}" }
                ]
            },
            {
                id: 5, topic: "6.1 Redox Reactions", title: "Sulfite Preservation Math",
                context: "Total electron exchange in 0.025 mol pharmaceutical sulfite titration.",
                eq: "5Na_2SO_3 + 2KMnO_4 + 3H_2SO_4 \\rightarrow 5Na_2SO_4 + 2MnSO_4 + K_2SO_4 + 3H_2O",
                steps: [
                    { h: "Calculus", c: "n(e^-) = 0.025 \\text{ mol } \\times 5 = 0.125 \\text{ mol } e^-" },
                    { h: "Final Result", c: "0.125 \\times 6.022 \\times 10^{23} = 7.53 \\times 10^{22} \\text{ electrons}" }
                ]
            },
            {
                id: 6, topic: "6.1 Redox Reactions", title: "Nitrite Biological reduction",
                context: "NO₂⁻ conversion to NO in biological acidic matrices.",
                steps: [
                    { h: "Redox Agents", c: "OA: Potassium Permanganate \\quad | \\quad RA: Potassium Nitrite" },
                    { h: "Final Eq", c: "5KNO_2 + 2KMnO_4 + 3H_2SO_4 \\rightarrow 5KNO_3 + 2MnSO_4 + K_2SO_4 + 3H_2O" }
                ],
                eq: "5KNO_2 + 2KMnO_4 + 3H_2SO_4 \\rightarrow 5KNO_3 + 2MnSO_4 + K_2SO_4 + 3H_2O"
            },
            {
                id: 7, topic: "5.2 Electrochemistry", title: "Silver Electrode Cell Potential",
                context: "Measuring standard potential for Cu + 2Ag⁺ → Cu²⁺ + 2Ag electrodes.",
                steps: [
                    { h: "Potentials", c: "E^o_{Ag} = +0.799V \\quad | \\quad E^o_{Cu} = +0.337V" },
                    { h: "E°cell output", c: "E^o_{cell} = 0.799 - 0.337 = +0.462V" },
                    { h: "Conclusion", c: "\\text{Confirmed Spontaneous (Positive E°cell).}" }
                ]
            },
            {
                id: 8, topic: "5.2 Electrochemistry", title: "Daniell Cell Max Work",
                context: "ΔG° (Maximum electrical work) for standard Zn-Cu system.",
                steps: [
                    { h: "Standard E°", c: "0.337 - (-0.760) = 1.097V" },
                    { h: "Work output", c: "\\Delta G^o = -nFE^o = -211.7 \\text{ kJ/mol}" }
                ]
            },
            {
                id: 9, topic: "5.2 Electrochemistry", title: "Iodine-Iodide Clinical Potential",
                context: "RED/OX assay directionality for clinical samples.",
                steps: [
                    { h: "Calculation", c: "E^o_{cell} = 0.771 - 0.536 = +0.235V" },
                    { h: "Direction", c: "\\text{Forward Spontaneous: Fe}^{3+} \\text{ oxidizes } I^-." }
                ]
            },
            {
                id: 10, topic: "5.2 Electrochemistry", title: "Hydrogen Peroxide System",
                context: "H₂O₂ titration potential in medical diagnostic acidic media.",
                eq: "2MnO_4^- + 5H_2O_2 + 6H^+ \\rightarrow 2Mn^{2+} + 5O_2 + 8H_2O",
                steps: [
                    { h: "Potential E°", c: "E^o_{cell} = 1.510 - 0.682 = +0.828V" },
                    { h: "Spontaneity", c: "\\text{Highly Spontaneous reaction.}" }
                ]
            },
            {
                id: 11, topic: "5.2 Electrochemistry", title: "Chlorine Spontaneity sweep",
                context: "Validating that Cl₂ spontaneously oxidizes bromide.",
                steps: [
                    { h: "Potential Output", c: "1.360 - 1.065 = +0.295V" },
                    { h: "Hierarchy", c: "\\text{Positive potential confirms Cl activity.}" }
                ]
            },
            {
                id: 12, topic: "5.2 Electrochemistry", title: "Cr(III) Potential Gibbs Energy",
                context: "Gibbs free energy for multi-electron analytical Cr test (n=30).",
                steps: [
                    { h: "E° Output", c: "1.510 - 1.330 = 0.180V" },
                    { h: "n-value Logic", c: "n = 30 \\text{ total electrons}" },
                    { h: "Gibbs Work", c: "\\Delta G^o = -(30)(96485)(0.180) = -521.0 \\text{ kJ/mol}" }
                ]
            },
            {
                id: 13, topic: "5.3 Nernst Equation", title: "Iron Redox (Physiological 310K)",
                context: "Assessment at 37°C body temperature and pH 7.0.",
                steps: [
                    { h: "E° Baseline", c: "0.630V" },
                    { h: "Nernst Calc", c: "E = 0.630 - \\frac{0.0615}{2} \\log(10^{-12}) = +0.999V" },
                    { h: "Equilibrium K", c: "K = 1.9 \\times 10^{21}" }
                ]
            },
            {
                id: 14, topic: "5.3 Nernst Equation", title: "Iodine-Bromide pH Shift",
                context: "Physiological assessment at 310K and pH 7.4.",
                steps: [
                    { h: "Actual E", c: "E = -0.529 - \\frac{0.0592}{2} \\log(0.01) = -0.470V" },
                    { h: "pH Impact", c: "\\text{Independent of pH change as } H^+ \\text{ is absent.}" }
                ]
            },
            {
                id: 15, topic: "5.3 Nernst Equation", title: "Clinical Oxalate Math",
                context: "Quantifying actual cell potential for titration informatics.",
                steps: [
                    { h: "Q Coefficient", c: "Q = 8 \\times 10^9" },
                    { h: "Final E output", c: "E = 1.069 - \\frac{0.0592}{10} \\log(Q) = +1.01V" }
                ]
            },
            {
                id: 16, topic: "5.3 Nernst Equation", title: "Bromate disinfection potential",
                context: "Clinical disinfection at 310K and pH 6.0.",
                steps: [
                    { h: "Standard E°", c: "0.375V" },
                    { h: "Nernst Step", c: "E = 0.375 - \\frac{0.0615}{5} \\log(3.2 \\times 10^{38}) = -0.098V" }
                ]
            }
        ];

        let activeId = 0;

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('-translate-x-full');
            document.getElementById('sidebarOverlay').classList.toggle('hidden');
        }

        function toggleSyllabus() {
            const mod = document.getElementById('syllabusModal');
            if(mod.classList.contains('hidden')) {
                mod.classList.remove('hidden');
                setTimeout(() => mod.classList.replace('opacity-0', 'opacity-100'), 10);
            } else {
                mod.classList.replace('opacity-100', 'opacity-0');
                setTimeout(() => mod.classList.add('hidden'), 500);
            }
        }

        function loadUnit(id) {
            activeId = id;
            const p = DATABASE.find(x => x.id === id);
            
            // Layout Shift
            document.getElementById('welcomeView').classList.add('hidden');
            const canvas = document.getElementById('solutionCanvas');
            canvas.classList.remove('hidden');
            canvas.classList.replace('reveal', 'dummy'); void canvas.offsetWidth; canvas.classList.replace('dummy', 'reveal');

            // Show Navigation
            const footer = document.getElementById('masterFooter');
            footer.classList.remove('opacity-0', 'translate-y-full', 'pointer-events-none');

            // Header Meta
            document.getElementById('titleRef').innerText = p.title;
            document.getElementById('topicRef').innerText = p.topic;
            document.getElementById('unitIndicator').innerText = `UNIT: ${String(id).padStart(2, '0')} / 16`;

            // Fix Logic: Buttons and Navigation
            document.getElementById('prevBtn').disabled = (id === 1);
            if (id === 16) {
                document.getElementById('nextBtn').classList.add('hidden');
                document.getElementById('homeBtn').classList.remove('hidden');
            } else {
                document.getElementById('nextBtn').classList.remove('hidden');
                document.getElementById('homeBtn').classList.add('hidden');
            }

            // Progress Tracking
            const prog = (id / 16) * 100;
            document.getElementById('progBar').style.width = prog + "%";
            document.getElementById('progLabel').innerText = Math.round(prog) + "%";

            // Sidebar Active UI
            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.dataset.id) === id) btn.classList.add('active');
            });

            // Content Mapping (FIXING TYPOGRAPHY PROBLEM)
            canvas.innerHTML = `
                <div class="space-y-10">
                    <div class="flex items-center gap-6">
                        <div class="w-14 h-14 rounded-2xl bg-medical/10 border border-medical/20 flex items-center justify-center text-medical shadow-xl">
                            <i data-lucide="microscope"></i>
                        </div>
                        <div>
                            <span class="text-[8px] font-black text-medical uppercase tracking-[0.6em] block mb-1">Authenticated Dataset Module ${p.id}</span>
                            <h2 class="text-2xl md:text-4xl font-black tracking-tighter uppercase italic text-white">${p.title}</h2>
                        </div>
                    </div>

                    <div class="p-8 md:p-12 glass-obsidian rounded-[3rem] relative overflow-hidden group shadow-2xl">
                        <div class="absolute -bottom-20 -right-20 opacity-5 group-hover:opacity-10 transition-opacity"><i data-lucide="dna" class="w-96 h-96 text-medical"></i></div>
                        <h4 class="text-[8px] font-black text-gray-600 uppercase tracking-widest mb-5 flex items-center gap-3">
                            <span class="w-10 h-[1px] bg-medical"></span> Scenario Logic
                        </h4>
                        <p class="text-xl md:text-2xl text-gray-400 font-light italic leading-relaxed mb-10">"${p.context}"</p>
                        
                        ${p.eq ? `
                            <div class="bg-black/80 p-8 rounded-3xl border border-white/5 text-center math-safe-zone shadow-inner">
                                <div id="math-formula" class="inline-block px-6"></div>
                            </div>
                        ` : ''}
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        ${p.steps.map((s, i) => `
                            <div class="p-8 rounded-[2.5rem] bg-white/[0.01] border border-white/5 hover:border-medical/40 transition-all duration-700">
                                <h5 class="text-[9px] font-black text-medical uppercase tracking-widest mb-4 flex items-center gap-2">
                                    <i data-lucide="chevron-right" class="w-4 h-4"></i> ${s.h}
                                </h5>
                                <div class="math-safe-zone">
                                    <div id="math-step-${i}" class="text-base text-white inline-block italic"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            if (p.eq) katex.render(p.eq, document.getElementById('math-formula'), { throwOnError: false });
            p.steps.forEach((s, idx) => katex.render(s.c, document.getElementById(`math-step-${idx}`), { throwOnError: false }));

            lucide.createIcons();
            document.getElementById('masterHub').scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextUnit() { if (activeId < 16) loadUnit(activeId + 1); }
        function prevUnit() { if (activeId > 1) loadUnit(activeId - 1); }

        function constructSidebar() {
            const list = document.getElementById('sidebarNav');
            DATABASE.forEach(p => {
                const btn = document.createElement('button');
                btn.className = "nav-link w-full text-left px-8 py-5 rounded-2xl flex items-center justify-between text-gray-600 hover:bg-white/5 transition-all group";
                btn.dataset.id = p.id;
                btn.innerHTML = `
                    <div class="flex flex-col">
                        <span class="text-[7px] font-black text-gray-700 uppercase tracking-widest leading-none mb-1">${p.cat}</span>
                        <span class="text-[10px] font-bold transition-colors group-hover:text-white uppercase truncate pr-4 max-w-[170px] font-mono italic">${p.id}. ${p.title}</span>
                    </div>
                    <i data-lucide="chevron-right" class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-all"></i>
                `;
                btn.onclick = () => { loadUnit(p.id); if(window.innerWidth < 1024) toggleSidebar(); };
                list.appendChild(btn);
            });
            lucide.createIcons();
        }

        window.onload = constructSidebar;
    </script>
</body>
</html>


